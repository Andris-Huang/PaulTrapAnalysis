harmonics = {0: ['1'], # l = 0
             1: ['-y', 'z', '-x'],
             2: ['6*x*y', '-3*y*z', '-1/2 * x**2 - 1/2 * y**2 + z**2', '-3*x*z', '3*x**2 - 3*y**2'],
             3: ['-45*x**2*y + 15*y**3', '30*x*y*z', '3/2*x**2*y+3/2*y**3-6*y*z**2', 'z**3-3/2*(x**2+y**2)*z',
                 '3/2*x**3+3/2*x*y**2-6*x*z**2', '15*(x**2-y**2)*z', '-15*x**3+45*x*y**2'],
             4: ['420*x**3*y-420*x*y**3', '-105*(3*x**2*y-y**3)*z', '-15*x**3*y-15*x*y**3+90*x*y*z**2',
                 '-10*y*z**3+15/2*(x**2*y+y**3)*z', '3/8*x**4+3/4*x**2*y**2+3/8*y**4+z**4-3*(x**2+y**2)*z**2',
                 '-10*x*z**3+15/2*(x**3+x*y**2)*z', '-15/2*x**4+15/2*y**4+45*(x**2-y**2)*z**2',
                 '-105*(x**3-3*x*y**2)*z', '105*x**4-630*x**2*y**2+105*y**4'],
             5: ['-4725*x**4*y + 9450*x**2*y**3 - 945*y**5', '3780*(x**3*y - x*y**3)*z',
                 '315/2*x**4*y + 105*x**2*y**3 - 105/2*y**5 - 420*(3*x**2*y - y**3)*z**2',
                 '210*x*y*z**3 - 105*(x**3*y+x*y**3)*z', 
                 '-15/8*x**4*y - 15/4*x**2*y**3 - 15/8*y**5 - 15*y*z**4 + 45/2*(x**2*y+y**3)*z**2',
                 'z**5 - 5*(x**2+y**2)*z**3 + 15/8*(x**4 + 2*x**2*y**2 + y**4)*z',
                 '-15/8*x**5 - 15/4*x**3*y**2 - 15/8*x*y**4 - 15*x*z**4 + 45/2*(x**3 + x*y**2)*z**2',
                 '105*(x**2-y**2)*z**3 - 105/2*(x**4-y**4)*z',
                 '105/2*x**5 - 105*x**3*y**2 - 315/2*x*y**4 - 420*(x**3 - 3*x*y**2)*z**2',
                 '945*(x**4 - 6*x**2*y**2 + y**4) * z', '-945*x**5 + 9450*x**3*y**2 - 4725*x*y**4'
                 ],
             6: ['62370*x**5*y - 207900*x**3*y**3 + 62370*x*y**5', '-10395*(5*x**4*y - 10*x**2*y**3 + y**5) *z',
                 '-1890*x**5*y + 1890*x*y**5 + 18900*(x**3*y-x*y**3)*z**2',
                 '-1260*(3*x**2*y-y**3)*z**3 + 945/2*(3*x**4*y+2*x**2*y**3-y**5)*z',
                 '105/4*x**5*y + 105/2*x**3*y**3 + 105/4*x*y**5 + 420*x*y*z**4 - 420*(x**3*y+x*y**3)*z**2',
                 '-21*y*z**5 + 105/2*(x**2*y+y**3)*z**3 - 105/8*(x**4*y + 2*x**2*y**3 + y**5)*z', # m = -1
                 '-5/16*x**6 - 15/16*x**4*y**2 - 15/16*x**2*y**4 - 5/16*y**6 + z**6 - 15/2*(x**2+y**2)*z**4 + 45/8*(x**4+2*x**2*y**2+y**4)*z**2',
                 '-21*x*z**5 + 105/2*(x**3+x*y**2)*z**3 - 105/8*(x**5+2*x**3*y**2+x*y**4)*z',
                 '105/8*x**6 + 105/8*x**4*y**2 - 105/8*x**2*y**4 - 105/8*y**6 + 210*(x**2-y**2)*z**4 - 210*(x**4-y**4)*z**2',
                 '-1260*(x**3-3*x*y**2)*z**3 + 945/2*(x**5 - 2*x**3*y**2 - 3*x*y**4)*z', # m = 3
                 '-945/2*x**6 + 4725/2*x**4*y**2 + 4725/2*x**2*y**4 - 945/2*y**6 + 4725*(x**4-6*x**2*y**2+y**4)*z**2',
                 '-10395*(x**5 - 10*x**3*y**2 + 5*x*y**4)*z', '10395*x**6 - 155925*x**4*y**2 + 155925*x**2*y**4 - 10395*y**6']
             }

gradients = {0: '[[0,0,0]]',
             1: "[[0, -1, 0], [0, 0, 1], [-1, 0, 0]]",
             2: "[[6*y, 6*x, 0], [0, -3*z, -3*y], [-1.0*x, -1.0*y, 2*z], [-3*z, 0, -3*x], [6*x, -6*y, 0]]",
             3: "[[-90*x*y, -45*x**2 + 45*y**2, 0], [30*y*z, 30*x*z, 30*x*y], [3.0*x*y, 1.5*x**2 + 4.5*y**2 - 6*z**2, -12*y*z], \
                 [-3.0*x*z, -3.0*y*z, -1.5*x**2 - 1.5*y**2 + 3*z**2], [4.5*x**2 + 1.5*y**2 - 6*z**2, 3.0*x*y, -12*x*z], \
                 [30*x*z, -30*y*z, 15*x**2 - 15*y**2], [-45*x**2 + 45*y**2, 90*x*y, 0]]",
             4: "[[1260*x**2*y - 420*y**3, 420*x**3 - 1260*x*y**2, 0], [-630*x*y*z, z*(-315*x**2 + 315*y**2), -315*x**2*y + 105*y**3],\
                 [-45*x**2*y - 15*y**3 + 90*y*z**2, -15*x**3 - 45*x*y**2 + 90*x*z**2, 180*x*y*z], [15.0*x*y*z, -10*z**3 + z*(7.5*x**2 + 22.5*y**2), 7.5*x**2*y + 7.5*y**3 - 30*y*z**2],\
                 [1.5*x**3 + 1.5*x*y**2 - 6*x*z**2, 1.5*x**2*y + 1.5*y**3 - 6*y*z**2, 4*z**3 - 2*z*(3*x**2 + 3*y**2)], [-10*z**3 + z*(22.5*x**2 + 7.5*y**2), 15.0*x*y*z, 7.5*x**3 + 7.5*x*y**2 - 30*x*z**2],\
                 [-30.0*x**3 + 90*x*z**2, 30.0*y**3 - 90*y*z**2, 2*z*(45*x**2 - 45*y**2)],[z*(-315*x**2 + 315*y**2), 630*x*y*z, -105*x**3 + 315*x*y**2], \
                 [420*x**3 - 1260*x*y**2, -1260*x**2*y + 420*y**3, 0]]",
             5: "[[-18900*x**3*y + 18900*x*y**3, -4725*x**4 + 28350*x**2*y**2 - 4725*y**4, 0], [z*(11340*x**2*y - 3780*y**3), z*(3780*x**3 - 11340*x*y**2), 3780*x**3*y - 3780*x*y**3],\
                 [630.0*x**3*y + 210*x*y**3 - 2520*x*y*z**2, 157.5*x**4 + 315*x**2*y**2 - 262.5*y**4 - z**2*(1260*x**2 - 1260*y**2), -2*z*(1260*x**2*y - 420*y**3)], [210*y*z**3 - z*(315*x**2*y + 105*y**3), 210*x*z**3 - z*(105*x**3 + 315*x*y**2), -105*x**3*y - 105*x*y**3 + 630*x*y*z**2],\
                 [-7.5*x**3*y - 7.5*x*y**3 + 45.0*x*y*z**2, -1.875*x**4 - 11.25*x**2*y**2 - 9.375*y**4 - 15*z**4 + z**2*(22.5*x**2 + 67.5*y**2), -60*y*z**3 + 2*z*(22.5*x**2*y + 22.5*y**3)], [-10*x*z**3 + z*(7.5*x**3 + 7.5*x*y**2), -10*y*z**3 + z*(7.5*x**2*y + 7.5*y**3), 1.875*x**4 + 3.75*x**2*y**2 + 1.875*y**4 + 5*z**4 - 3*z**2*(5*x**2 + 5*y**2)],\
                 [-9.375*x**4 - 11.25*x**2*y**2 - 1.875*y**4 - 15*z**4 + z**2*(67.5*x**2 + 22.5*y**2), -7.5*x**3*y - 7.5*x*y**3 + 45.0*x*y*z**2, -60*x*z**3 + 2*z*(22.5*x**3 + 22.5*x*y**2)], [-210.0*x**3*z + 210*x*z**3, 210.0*y**3*z - 210*y*z**3, -52.5*x**4 + 52.5*y**4 + 3*z**2*(105*x**2 - 105*y**2)],\
                 [262.5*x**4 - 315*x**2*y**2 - 157.5*y**4 - z**2*(1260*x**2 - 1260*y**2), -210*x**3*y - 630.0*x*y**3 + 2520*x*y*z**2, -2*z*(420*x**3 - 1260*x*y**2)], [z*(3780*x**3 - 11340*x*y**2), z*(-11340*x**2*y + 3780*y**3), 945*x**4 - 5670*x**2*y**2 + 945*y**4],\
                 [-4725*x**4 + 28350*x**2*y**2 - 4725*y**4, 18900*x**3*y - 18900*x*y**3, 0]]",
             6: "[[311850*x**4*y - 623700*x**2*y**3 + 62370*y**5, 62370*x**5 - 623700*x**3*y**2 + 311850*x*y**4, 0], [z*(-207900*x**3*y + 207900*x*y**3), z*(-51975*x**4 + 311850*x**2*y**2 - 51975*y**4), -51975*x**4*y + 103950*x**2*y**3 - 10395*y**5],\
                 [-9450*x**4*y + 1890*y**5 + z**2*(56700*x**2*y - 18900*y**3), -1890*x**5 + 9450*x*y**4 + z**2*(18900*x**3 - 56700*x*y**2), 2*z*(18900*x**3*y - 18900*x*y**3)], [-7560*x*y*z**3 + z*(5670.0*x**3*y + 1890.0*x*y**3), z**3*(-3780*x**2 + 3780*y**2) + z*(1417.5*x**4 + 2835.0*x**2*y**2 - 2362.5*y**4), 1417.5*x**4*y + 945.0*x**2*y**3 - 472.5*y**5 + 3*z**2*(-3780*x**2*y + 1260*y**3)],\
                 [131.25*x**4*y + 157.5*x**2*y**3 + 26.25*y**5 + 420*y*z**4 - z**2*(1260*x**2*y + 420*y**3), 26.25*x**5 + 157.5*x**3*y**2 + 131.25*x*y**4 + 420*x*z**4 - z**2*(420*x**3 + 1260*x*y**2), 1680*x*y*z**3 - 2*z*(420*x**3*y + 420*x*y**3)], [105.0*x*y*z**3 - z*(52.5*x**3*y + 52.5*x*y**3), -21*z**5 + z**3*(52.5*x**2 + 157.5*y**2) - z*(13.125*x**4 + 78.75*x**2*y**2 + 65.625*y**4), -13.125*x**4*y - 26.25*x**2*y**3 - 13.125*y**5 - 105*y*z**4 + 3*z**2*(52.5*x**2*y + 52.5*y**3)],\
                 [-1.875*x**5 - 3.75*x**3*y**2 - 1.875*x*y**4 - 15.0*x*z**4 + z**2*(22.5*x**3 + 22.5*x*y**2), -1.875*x**4*y - 3.75*x**2*y**3 - 1.875*y**5 - 15.0*y*z**4 + z**2*(22.5*x**2*y + 22.5*y**3), 6*z**5 - 4*z**3*(7.5*x**2 + 7.5*y**2) + 2*z*(5.625*x**4 + 11.25*x**2*y**2 + 5.625*y**4)], [-21*z**5 + z**3*(157.5*x**2 + 52.5*y**2) - z*(65.625*x**4 + 78.75*x**2*y**2 + 13.125*y**4), 105.0*x*y*z**3 - z*(52.5*x**3*y + 52.5*x*y**3), -13.125*x**5 - 26.25*x**3*y**2 - 13.125*x*y**4 - 105*x*z**4 + 3*z**2*(52.5*x**3 + 52.5*x*y**2)],\
                 [78.75*x**5 + 52.5*x**3*y**2 - 840*x**3*z**2 - 26.25*x*y**4 + 420*x*z**4, 26.25*x**4*y - 52.5*x**2*y**3 - 78.75*y**5 + 840*y**3*z**2 - 420*y*z**4, 4*z**3*(210*x**2 - 210*y**2) - 2*z*(210*x**4 - 210*y**4)], [z**3*(-3780*x**2 + 3780*y**2) + z*(2362.5*x**4 - 2835.0*x**2*y**2 - 1417.5*y**4), 7560*x*y*z**3 + z*(-1890.0*x**3*y - 5670.0*x*y**3), 472.5*x**5 - 945.0*x**3*y**2 - 1417.5*x*y**4 + 3*z**2*(-1260*x**3 + 3780*x*y**2)],\
                 [-2835.0*x**5 + 9450.0*x**3*y**2 + 4725.0*x*y**4 + z**2*(18900*x**3 - 56700*x*y**2), 4725.0*x**4*y + 9450.0*x**2*y**3 - 2835.0*y**5 + z**2*(-56700*x**2*y + 18900*y**3), 2*z*(4725*x**4 - 28350*x**2*y**2 + 4725*y**4)], [z*(-51975*x**4 + 311850*x**2*y**2 - 51975*y**4), z*(207900*x**3*y - 207900*x*y**3), -10395*x**5 + 103950*x**3*y**2 - 51975*x*y**4],\
                 [62370*x**5 - 623700*x**3*y**2 + 311850*x*y**4, -311850*x**4*y + 623700*x**2*y**3 - 62370*y**5, 0]]"
            }

gradients_separated = {
             0: ['[0,0,0]'],
             1: ["[0, -1, 0]", "[0, 0, 1]", "[-1, 0, 0]"],
             2: ["[6*y, 6*x, 0]", "[0, -3*z, -3*y]", "[-1.0*x, -1.0*y, 2*z]", "[-3*z, 0, -3*x]", "[6*x, -6*y, 0]"],
             3: ["[-90*x*y, -45*x**2 + 45*y**2, 0]", "[30*y*z, 30*x*z, 30*x*y]", "[3.0*x*y, 1.5*x**2 + 4.5*y**2 - 6*z**2, -12*y*z]",
                 "[-3.0*x*z, -3.0*y*z, -1.5*x**2 - 1.5*y**2 + 3*z**2]", "[4.5*x**2 + 1.5*y**2 - 6*z**2, 3.0*x*y, -12*x*z]", 
                 "[30*x*z, -30*y*z, 15*x**2 - 15*y**2]", "[-45*x**2 + 45*y**2, 90*x*y, 0]"],
             4: ["[1260*x**2*y - 420*y**3, 420*x**3 - 1260*x*y**2, 0]", "[-630*x*y*z, z*(-315*x**2 + 315*y**2), -315*x**2*y + 105*y**3]",
                 "[-45*x**2*y - 15*y**3 + 90*y*z**2, -15*x**3 - 45*x*y**2 + 90*x*z**2, 180*x*y*z]", "[15.0*x*y*z, -10*z**3 + z*(7.5*x**2 + 22.5*y**2), 7.5*x**2*y + 7.5*y**3 - 30*y*z**2]",
                 "[1.5*x**3 + 1.5*x*y**2 - 6*x*z**2, 1.5*x**2*y + 1.5*y**3 - 6*y*z**2, 4*z**3 - 2*z*(3*x**2 + 3*y**2)]", "[-10*z**3 + z*(22.5*x**2 + 7.5*y**2), 15.0*x*y*z, 7.5*x**3 + 7.5*x*y**2 - 30*x*z**2]",
                 "[-30.0*x**3 + 90*x*z**2, 30.0*y**3 - 90*y*z**2, 2*z*(45*x**2 - 45*y**2)]","[z*(-315*x**2 + 315*y**2), 630*x*y*z, -105*x**3 + 315*x*y**2]", 
                 "[420*x**3 - 1260*x*y**2, -1260*x**2*y + 420*y**3, 0]"],
             5: ["[-18900*x**3*y + 18900*x*y**3, -4725*x**4 + 28350*x**2*y**2 - 4725*y**4, 0]", "[z*(11340*x**2*y - 3780*y**3), z*(3780*x**3 - 11340*x*y**2), 3780*x**3*y - 3780*x*y**3]",
                 "[630.0*x**3*y + 210*x*y**3 - 2520*x*y*z**2, 157.5*x**4 + 315*x**2*y**2 - 262.5*y**4 - z**2*(1260*x**2 - 1260*y**2), -2*z*(1260*x**2*y - 420*y**3)]", "[210*y*z**3 - z*(315*x**2*y + 105*y**3), 210*x*z**3 - z*(105*x**3 + 315*x*y**2), -105*x**3*y - 105*x*y**3 + 630*x*y*z**2]",
                 "[-7.5*x**3*y - 7.5*x*y**3 + 45.0*x*y*z**2, -1.875*x**4 - 11.25*x**2*y**2 - 9.375*y**4 - 15*z**4 + z**2*(22.5*x**2 + 67.5*y**2), -60*y*z**3 + 2*z*(22.5*x**2*y + 22.5*y**3)]", "[-10*x*z**3 + z*(7.5*x**3 + 7.5*x*y**2), -10*y*z**3 + z*(7.5*x**2*y + 7.5*y**3), 1.875*x**4 + 3.75*x**2*y**2 + 1.875*y**4 + 5*z**4 - 3*z**2*(5*x**2 + 5*y**2)]",
                 "[-9.375*x**4 - 11.25*x**2*y**2 - 1.875*y**4 - 15*z**4 + z**2*(67.5*x**2 + 22.5*y**2), -7.5*x**3*y - 7.5*x*y**3 + 45.0*x*y*z**2, -60*x*z**3 + 2*z*(22.5*x**3 + 22.5*x*y**2)]", "[-210.0*x**3*z + 210*x*z**3, 210.0*y**3*z - 210*y*z**3, -52.5*x**4 + 52.5*y**4 + 3*z**2*(105*x**2 - 105*y**2)]",
                 "[262.5*x**4 - 315*x**2*y**2 - 157.5*y**4 - z**2*(1260*x**2 - 1260*y**2), -210*x**3*y - 630.0*x*y**3 + 2520*x*y*z**2, -2*z*(420*x**3 - 1260*x*y**2)]", "[z*(3780*x**3 - 11340*x*y**2), z*(-11340*x**2*y + 3780*y**3), 945*x**4 - 5670*x**2*y**2 + 945*y**4]",
                 "[-4725*x**4 + 28350*x**2*y**2 - 4725*y**4, 18900*x**3*y - 18900*x*y**3, 0]"],
             6: ["[311850*x**4*y - 623700*x**2*y**3 + 62370*y**5, 62370*x**5 - 623700*x**3*y**2 + 311850*x*y**4, 0]", "[z*(-207900*x**3*y + 207900*x*y**3), z*(-51975*x**4 + 311850*x**2*y**2 - 51975*y**4), -51975*x**4*y + 103950*x**2*y**3 - 10395*y**5]",
                 "[-9450*x**4*y + 1890*y**5 + z**2*(56700*x**2*y - 18900*y**3), -1890*x**5 + 9450*x*y**4 + z**2*(18900*x**3 - 56700*x*y**2), 2*z*(18900*x**3*y - 18900*x*y**3)]", "[-7560*x*y*z**3 + z*(5670.0*x**3*y + 1890.0*x*y**3), z**3*(-3780*x**2 + 3780*y**2) + z*(1417.5*x**4 + 2835.0*x**2*y**2 - 2362.5*y**4), 1417.5*x**4*y + 945.0*x**2*y**3 - 472.5*y**5 + 3*z**2*(-3780*x**2*y + 1260*y**3)]",
                 "[131.25*x**4*y + 157.5*x**2*y**3 + 26.25*y**5 + 420*y*z**4 - z**2*(1260*x**2*y + 420*y**3), 26.25*x**5 + 157.5*x**3*y**2 + 131.25*x*y**4 + 420*x*z**4 - z**2*(420*x**3 + 1260*x*y**2), 1680*x*y*z**3 - 2*z*(420*x**3*y + 420*x*y**3)]", "[105.0*x*y*z**3 - z*(52.5*x**3*y + 52.5*x*y**3), -21*z**5 + z**3*(52.5*x**2 + 157.5*y**2) - z*(13.125*x**4 + 78.75*x**2*y**2 + 65.625*y**4), -13.125*x**4*y - 26.25*x**2*y**3 - 13.125*y**5 - 105*y*z**4 + 3*z**2*(52.5*x**2*y + 52.5*y**3)]",
                 "[-1.875*x**5 - 3.75*x**3*y**2 - 1.875*x*y**4 - 15.0*x*z**4 + z**2*(22.5*x**3 + 22.5*x*y**2), -1.875*x**4*y - 3.75*x**2*y**3 - 1.875*y**5 - 15.0*y*z**4 + z**2*(22.5*x**2*y + 22.5*y**3), 6*z**5 - 4*z**3*(7.5*x**2 + 7.5*y**2) + 2*z*(5.625*x**4 + 11.25*x**2*y**2 + 5.625*y**4)]", "[-21*z**5 + z**3*(157.5*x**2 + 52.5*y**2) - z*(65.625*x**4 + 78.75*x**2*y**2 + 13.125*y**4), 105.0*x*y*z**3 - z*(52.5*x**3*y + 52.5*x*y**3), -13.125*x**5 - 26.25*x**3*y**2 - 13.125*x*y**4 - 105*x*z**4 + 3*z**2*(52.5*x**3 + 52.5*x*y**2)]",
                 "[78.75*x**5 + 52.5*x**3*y**2 - 840*x**3*z**2 - 26.25*x*y**4 + 420*x*z**4, 26.25*x**4*y - 52.5*x**2*y**3 - 78.75*y**5 + 840*y**3*z**2 - 420*y*z**4, 4*z**3*(210*x**2 - 210*y**2) - 2*z*(210*x**4 - 210*y**4)]", "[z**3*(-3780*x**2 + 3780*y**2) + z*(2362.5*x**4 - 2835.0*x**2*y**2 - 1417.5*y**4), 7560*x*y*z**3 + z*(-1890.0*x**3*y - 5670.0*x*y**3), 472.5*x**5 - 945.0*x**3*y**2 - 1417.5*x*y**4 + 3*z**2*(-1260*x**3 + 3780*x*y**2)]",
                 "[-2835.0*x**5 + 9450.0*x**3*y**2 + 4725.0*x*y**4 + z**2*(18900*x**3 - 56700*x*y**2), 4725.0*x**4*y + 9450.0*x**2*y**3 - 2835.0*y**5 + z**2*(-56700*x**2*y + 18900*y**3), 2*z*(4725*x**4 - 28350*x**2*y**2 + 4725*y**4)]", "[z*(-51975*x**4 + 311850*x**2*y**2 - 51975*y**4), z*(207900*x**3*y - 207900*x*y**3), -10395*x**5 + 103950*x**3*y**2 - 51975*x*y**4]",
                 "[62370*x**5 - 623700*x**3*y**2 + 311850*x*y**4, -311850*x**4*y + 623700*x**2*y**3 - 62370*y**5, 0]"]
            }